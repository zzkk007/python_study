"---------------------------------------------------------------"

						网络编程

"---------------------------------------------------------------"

1、什么是网络？

	网络就是一种辅助双方或者多方能够连接在一起的工具
	如果没有网络，单机的世界是多么孤单

2、使用网络的目的？

	就是为了联通多方然后进行通信用的，即把数据从一方传递到另一方。

	为了让在不同的电脑上运行软件，之间能够互相传递数据，就需要借助网络功能。

	使用网络能够把多方链接在一起，然后可以进行数据传递，所谓的网络编程就是，让在不同的
	电脑上的软件能够进行数据传递，即进程之间的通信。


3、什么是协议？

	就像说不同语言的人沟通一样，只要有一种大家都认可都遵守的协议即可，
	那么这个计算机都遵守的网络通信协议叫做TCP/IP协议

	因为互联网协议包含了上百种协议标准，但是最重要的两个协议是TCP和IP协议，
	所以，大家把互联网的协议简称TCP/IP协议

	常用的网络协议有四层：应用层（应用进程）、传输层（tcp/udp）、网络层(ip)、链路层(网络接口层)

4、什么是端口

	端口就好像一个房子的门，是出入这间房子的必经之路。
	如果一个进程需要收发网络数据，那么就需要由这样的端口。
	在Linux系统中，端口可以有65536(2的16次方)之多。
	操作系统为了统一管理，进行了编号，就是端口号。
	
	端口号的分配：
		
		端口号不是随机使用的，而是按照一定的规定进行分配
		端口的分类标准有好几种，我们这里不做详细讲解，只介绍一下知名端口和动态端口

	知名端口号（Well Know Ports）:

		知名端口是众所周知的端口号，范围从0到1023
		一般情况下，如果一个程序需要使用知名端口的需要有root权限

	动态端口（Dynamic Ports）:

		动态端口的范围是从1024到65535
		之所以称为动态端口，是因为它一般不固定分配某种服务，而是动态分配。
	
		动态分配是指当一个系统进程或应用程序需要网络通信时，它向主机申请一个端口，
		主机从可用的端口中分配一个提供它使用。

		当这个进程关闭时，同时也就释放了所占用的端口号。

	怎样查看端口 ：
		netstat －an

	端口有什么用：
		
		一台拥有IP地址的主机可以提供许多服务，比如HTTP（万维网服务）、FTP（文件传输）、SMTP（电子邮件）等，
		这些服务完全可以通过1个IP地址来实现。那么主机是怎样区分不同的网络服务的呢？显然不能只靠ip地址，
		因为ip地址与网络服务的关系是一对多的关系。实际上是通过"ip地址+端口号"来区分不同的服务的，
		注意：端口并不是一一对应的。比如你的电脑作为客户机访问一台www服务器时，WWW服务器使用“80”端口与你的电脑通信，
		但你的电脑则可能使用“3457”这样的端口。


IP地址：

	ip地址：用来在网络中标记一台电脑的一串数字，比如192.168.1.1；在本地局域网上是惟一的。

ip地址的分类：

	每一个ip地址包括两部分：网络地址和主机地址

	A类IP地址：

		一个A类IP地址由1字节的网络地址和3字节主机地址组成，网络地址的最高位必须是“0”，

		地址范围1.0.0.1-126.255.255.254

		二进制表示为：00000001 00000000 00000000 00000001 - 01111110 11111111 11111111 11111110

		可用的A类网络有126个，每个网络能容纳1677214个主机

	B类IP地址：

		一个B类IP地址由2个字节的网络地址和2个字节的主机地址组成，网络地址的最高位必须是“10”，
		地址范围128.1.0.1-191.255.255.254
		二进制表示为：10000000 00000001 00000000 00000001 - 10111111 11111111 11111111 11111110
		可用的B类网络有16384个，每个网络能容纳65534主机

	C类IP地址：

		一个C类IP地址由3字节的网络地址和1字节的主机地址组成，网络地址的最高位必须是“110”
		范围192.0.1.1-223.255.255.254
		二进制表示为: 11000000 00000000 00000001 00000001 - 11011111 11111111 11111110 11111110
		C类网络可达2097152个，每个网络能容纳254个主机

	D类地址用于多点广播：
		
		D类IP地址第一个字节以“1110”开始，它是一个专门保留的地址。

		它并不指向特定的网络，目前这一类地址被用在多点广播（Multicast）中

		多点广播地址用来一次寻址一组计算机

		地址范围224.0.0.1-239.255.255.254

	E类IP地址：

		以“1111”开始，为将来使用保留
		E类地址保留，仅作实验和开发用

	私有ip：

		在这么多网络IP中，国际规定有一部分IP地址是用于我们的局域网使用，也就
		是属于私网IP，不在公网中使用的，它们的范围是：

		10.0.0.0～10.255.255.255

		172.16.0.0～172.31.255.255

		192.168.0.0～192.168.255.255

	注意：
		
		IP地址127．0．0．1~127．255．255．255用于回路测试
		127.0.0.1可以代表本机IP地址，用http://127.0.0.1就可以测试本机中配置的Web服务器。


子网掩码:

	要想理解什么是子网掩码，就不能不了解IP地址的构成。互联网是由许多小型网络构成的，
	每个网络上都有许多主机，这样便构成了一个有层次的结构。
	IP地址在设计时就考虑到地址分配的层次特点，
	将每个IP地址都分割成网络号和主机号两部分，以便于IP地址的寻址操作。

	IP地址的网络号和主机号各是多少位呢？
	如果不指定，就不知道哪些位是网络号、哪些是主机号，这就需要通过子网掩码来实现。
	子网掩码不能单独存在，它必须结合IP地址一起使用。
	子网掩码只有一个作用，就是将某个IP地址划分成网络地址和主机地址两部分.
	子网掩码的设定必须遵循一定的规则。

	与IP地址相同，子网掩码的长度也是32位，

		左边是网络位，用二进制数字“1”表示；
		右边是主机位，用二进制数字“0”表示。

	假设IP地址为“192.168.1.1”子网掩码为“255.255.255.0”

		其中，“1”有24个，代表与此相对应的IP地址左边24位是网络号；
		“0”有8个，代表与此相对应的IP地址右边8位是主机号。
		这样，子网掩码就确定了一个IP地址的32位二进制数字中哪些是网络号、哪些是主机号。
		这对于采用TCP/IP协议的网络来说非常重要，只有通过子网掩码，
		才能表明一台主机所在的子网与其他子网的关系，使网络正常工作。

	子网掩码是“255.255.255.0”的网络：

		最后面一个数字可以在0~255范围内任意变化，因此可以提供256个IP地址。
		但是实际可用的IP地址数量是256-2，即254个，因为主机号不能全是“0”或全是“1”。

		主机号全为0，表示网络号
		主机号全为1，表示网络广播


	如果将子网掩码设置过大，也就是说子网范围扩大，那么，根据子网寻径规则，
	很可能发往和本地主机不在同一子网内的目标主机的数据，会因为错误的判断而认为目标主机是在同一子网内，
	那么，数据包将在本子网内循环，直到超时并抛弃，使数据不能正确到达目标主机，导致网络传输错误；
	如果将子网掩码设置得过小，那么就会将本来属于同一子网内的机器之间的通信当做是跨子网传输，
	数据包都交给缺省网关处理，这样势必增加缺省网关(文章下方有解释)的负担，造成网络效率下降。
	因此，子网掩码应该根据网络的规模进行设置。如果一个网络的规模不超过254台电脑，
	采用“255.255.255.0”作为子网掩码就可以了，现在大多数局域网都不会超过这个数字，
	因此“255.255.255.0”是最常用的IP地址子网掩码；假如在一所大学具有1500多台电脑，
	这种规模的局域网可以使用“255.255.0.0”。



Socket:

	1、本地的进程间通信(IPC)有很多种方式：
		队列
		同步（互斥锁、条件变量等）

	2、网络中的进程之间如何通信:

		首先解决的问题是如何唯一标识一个进程，否则通信无从谈起，
		在本地可以通过进程pid来唯一标识一个进程，但是在网络中行不通。

		其实TCP/IP协议族已经帮我们解决了这个问题，网络层的“IP地址”可以唯一标识网络中的主机，
		而传输层的"协议+端口"可以唯一标识主机中的应用程序(进程)。

		这样利用 ip地址、协议、端口就可以标识网络的进程了，网络中的进程通信就可以利用
		这个标志和其他进程进行交互。

	3、什么是SOCKET:

		socket(简称 套接字)是进程间通信的一种方式，他与其他进程间通信的一个主要不同是：
		它能实现不同主机间的进程间通信，我们网络上各种各样的服务大多都是基于socket来完成
		通信的。例如：浏览网页、QQ、email等


	4、创建SOCKET：

		在python中使用socket模块的函数socket就可以完成：
		
			socket.socket(AddressFamily,Type)
			
			函数socket.socket,返回该socket的描述符，该函数带有两个参数：

			AddressFamily:
						可以选择AF_INT（用于internet进程间通信）或者AF_UNIX(用于同一台机器进程间通信)
					    实际工作中常用AF_INT

			Type:
				套接字类型，可以是SOCK_STREAM（流式套接字，主要用于TCP协议）
							SOCK_DGRAM（数据报套接字，主要用于UDP）

		创建一个tcp socket（tcp套接字）

			import socket

			s = socket.socket(socket.AF_INT,socket.SOCK_STREAM)

			print("Socket Created")


		创建一个UDP socket（udp套接字）

			import socket

			s = socket.socket(socket.AF_INT,socket.SOCK_DGRAM)

			print("Socket Created")


UDP介绍：
	
	UDP--用户数据报协议，是一个无连接的简单的面向数据报的运输层协议。
	UDP不提供可靠性，它只是把应用程序传给ip层的数据报发送出去，但是
	并不能保证它们能够到达目的地。
	由于UDP在传输数据报前不用在客户和服务器之间建立一个链接，切没有
	超时重发等机制，故而传输速度很快。

	UDP是一种面向无连接的协议，每个数据包都会是一个独立的信息，包括
	完整的源地址和目的地址，它在网络上以任何可能的路径传往目的地，
	因此能否到达目的地，到达目的地的时间以及内容的正确性都是不能被保证的。

	UDP特点:

		UDP是面向无连接的通讯协议，UDP数据包括目的端口号和源端口号信息
		由于通讯不需要连接，可以实现广播发送。
		UDP传输数据时有大小限制，每个被传输的数据报必须限定在64KB之内。
		UDP是一个不可靠的协议，发送方所发送的数据并不一定以相同的
		次序到达接收方。

	UDP是面向消息的协议，通讯时不需要建立连接，数据的传输自然是不可靠
		UDP一般用于多点通信和实时的数据业务。
		比如：
			语音广播、视频、QQ、TFTP(简单文件传输)、SNMP(简单网络管理协议)
			RIP（路由信息协议）、DNS（域名解释）

		注重速度流程

	UDP操作简单，而且仅需要较少的监护，因此通常用于局域网高可靠性的分散系统中client/server应用程序。
	例如视频会议系统，并不要求音频视频数据绝对的正确，只要保证连贯性就可以了，
	这种情况下显然使用UDP会更合理一些。



UDP网络程序-发送数据：
	
	创建一个UDP客户端程序的流程简单，步骤如下：
	
	UDP客户端:
		
		1、socket()创建客户端套接字

		2、sendto()发送

		3、recvfrom()接收

		4、close()关闭

		
	from socket import *

	1、创建套接字
	udpsocket = socket(AF_INT,SOCK_DGRAM)

	2、准备接收方地址
	sendAddr = ('172.25.16.226',8080)

	3、准备发送数据
	sendData = input("input send data:")

	4、发送数据到指定服务器
	udpsocket.sendto(sendData,dendAdrr)
	
	5、等待接收对方发送的数据，1024表示接收的最大字节数
	recvData = udpsocket.recvfrom(1024)

	6、显示数据
	print(recvData)
	
	7、关闭套接字
	udpsoclet.close

	每次重新运行一次网络程序，客户端的进程号是不确定的，系统默认随机分配
	记住一点：网络程序运行过程中，这就是唯一的标识，如果其他电脑上的网络程序
	想要向次程序发送数据，就需要向这个数字（端口）标识的程序发送。
	
	一般情况下，在一天电脑上运行的网络程序有很多，而各自用的端口号很多情况下不知道，
	为了不与其他的网络程序占用同一个端口号，往往在编程中，客户端udp的端口号一般不绑定。


	UDP服务器：服务器端的端口是绑定的。

		1、socket()创建服务器套接字

		2、bind()绑定ip和端口

		3、recvfrom()接收请求

		4、处理数据

		5、sendto()发送



	form  socket import *

	1、创建套接字
	udpsocket = socket(AF_INT,SOCK_DGARM)


	2、绑定Ip和端口,ip一般不用写，表示本机的任何一个ip
	bindAddr = ('',7788)
	udpsocket.bind(bindAddr)

	num = 1
	while True:

		3、等待接收对方发送的数据
		recvData = udpsocket.recvfrom(1024)

		4、将接收的数据再发送回去

		recvfData[0]接收到的数据
		print("recvfData[0]:%s")%(recvfData[0])  
		recvfData[1] ip和端口
		print("recvfData[1]:%s")%(str(recvfData[1]))

		udpsocket.sendto(recvData[0],recvData[1])
		
		5、统计信息
		print('已经将接收到的第%d个数据返回给对方,内容为:%s'%(num,recvData[0]))

		num += 1
		print(recvDatap地址，端口号）
	
	5、udpSocket.close()


	一个udp网络程序，可以不绑定，此时操作系统会随机进行分配一个端口，
		如果重新运行次程序端口可能会发生变化
	一个udp网络程序，也可以绑定信息（ip地址，端口号），如果绑定成功，
		那么操作系统用这个端口号来进行区别收到的网络数据是否是此进程的
	

udp网络通信过程：


	应用层：				hello

	运输层(传输层）：       目的端口|hello

	网络层：				目的IP|目的端口|hello

	链路层：                目的MAC|目的IP|目的端口|hello




udp总结:

	1、udp是TCP/IP协议族中的一种协议能够完成不同机器上的程序间的数据通信

	2、udp服务器、客户端

		udp的服务器和客户端的区分：往往是通过请求服务和提供服务来进行区分
		请求服务的一方称为：客户端
		提供服务的一方称为：服务器

	3、udp绑定问题

		一般情况下，服务器端，需要绑定端口，目的是为了让其他的客户端能够正确发送到此进程
		客户端，一般不需要绑定，而是让操作系统随机分配，
		这样就不会因为需要绑定的端口被占用而导致程序无法运行的情况



	


		
































	
		
			


















































	
	

		

	


	












































		
	



































































